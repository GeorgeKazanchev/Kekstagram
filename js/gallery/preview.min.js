"use strict";!function(){let e=document.querySelector("#comment"),t=document.querySelector(".big-picture"),n=t.querySelector(".big-picture__img > img"),c=t.querySelector(".likes-count"),o=t.querySelector(".comments-count"),l=t.querySelector(".social__caption"),r=t.querySelector(".big-picture__cancel"),s=t.querySelector(".social__comments"),i=t.querySelector(".social__comment-count"),d=t.querySelector(".comments-loader"),a=null,u=t=>{let n=e.content.cloneNode(!0);return n.querySelector(".social__picture").src=t.avatarUrl,n.querySelector(".social__text").textContent=t.text,n},m=(e,t)=>{let n=document.createDocumentFragment();e.forEach(e=>{n.append(u(e))}),t.innerHTML="",t.append(n),i.childNodes[0].textContent=`${e.length} из `,i.childNodes[2].textContent=` ${e.length%10==1&&11!==e.length?"комментария":"комментариев"}`},y=e=>{n.src=e.url,c.textContent=e.likes,o.textContent=e.comments.length,l.textContent=e.description;let t=e.comments.slice(0,5);m(t,s)},h=e=>{let n=Math.min(e.length,5);return function(){n+=5;let c=e.slice(0,n);m(c,s),c.length===e.length&&t.querySelector(".comments-loader").classList.add("hidden")}},p=e=>{e.length>5?d.classList.remove("hidden"):d.classList.add("hidden"),a=h(e),d.addEventListener("click",a)},g=()=>{d.removeEventListener("click",a),a=null},v=e=>{"Escape"===e.key&&q()},L=e=>{y(e),p(e.comments),t.classList.remove("hidden"),document.body.classList.add("modal-open"),document.addEventListener("keydown",v),setTimeout(()=>{r.focus()},0)},q=()=>{g(),t.classList.add("hidden"),document.body.classList.remove("modal-open"),document.removeEventListener("keydown",v)};r.addEventListener("click",()=>{q()}),r.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),q())}),window.preview={openPopup:L}}();
